---
name: keytao-create
description: é”®é“è¾“å…¥æ³•è¯æ¡åˆ›å»ºå·¥å…·ã€‚å½“ç”¨æˆ·è¦æ±‚æ·»åŠ è¯æ¡æ—¶è°ƒç”¨ã€‚å…³é”®è¯ï¼šæ·»åŠ ã€åˆ›å»ºã€æ–°å¢è¯æ¡ã€‚ä½¿ç”¨å‰éœ€æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç»‘å®šè´¦å·ã€‚
---

# é”®é“è¯æ¡åˆ›å»ºå·¥å…·

ä¸º AI åŠ©æ‰‹æä¾›åˆ›å»ºé”®é“è¾“å…¥æ³•è¯æ¡çš„èƒ½åŠ›ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡å¯¹è¯æ·»åŠ æ–°è¯æ¡åˆ°é”®é“è¯åº“ã€‚

## ä½¿ç”¨å‰æ

âš ï¸ **ç”¨æˆ·å¿…é¡»å…ˆç»‘å®šè´¦å·æ‰èƒ½ä½¿ç”¨æ­¤åŠŸèƒ½**
- å¦‚æœç”¨æˆ·æœªç»‘å®šï¼Œæç¤ºä½¿ç”¨ `/bind` å‘½ä»¤ç»‘å®šè´¦å·
- ç»‘å®šåæ‰èƒ½åˆ›å»ºè¯æ¡

## ä½¿ç”¨åœºæ™¯

å½“ç”¨æˆ·ä»¥ä¸‹åˆ—æ–¹å¼è¡¨è¾¾æ·»åŠ è¯æ¡éœ€æ±‚æ—¶è°ƒç”¨ï¼š

- "æ·»åŠ è¯æ¡ï¼šæµ‹è¯• ç¼–ç ï¼šushi"
- "å¸®æˆ‘åŠ ä¸ªè¯ï¼šä½ å¥½ yhao"
- "åˆ›å»ºæ–°è¯ï¼šé˜¿å·´é˜¿å·´ abab"
- "æŠŠã€è¯æ¡ã€‘åŠ åˆ°è¯åº“ï¼Œç¼–ç æ˜¯ã€ç¼–ç ã€‘"

## å·¥å…·å‡½æ•°

### keytao_create_phrase

åˆ›å»ºå•ä¸ªè¯æ¡

**å‚æ•°ï¼š**
- `platform` (str): å¹³å°ç±»å‹ - 'qq' æˆ– 'telegram'
- `platform_id` (str): ç”¨æˆ·çš„å¹³å°ID
- `word` (str): è¯æ¡å†…å®¹
- `code` (str): ç¼–ç 
- `type` (str, optional): è¯æ¡ç±»å‹ï¼Œé»˜è®¤ 'Phrase'ã€‚å¯é€‰ï¼š
  - `Single`: å•å­—
  - `Phrase`: è¯ç»„ï¼ˆé»˜è®¤ï¼‰
  - `Supplement`: è¡¥å……è¯æ¡
  - `Symbol`: ç¬¦å·
  - `English`: è‹±æ–‡
- `remark` (str, optional): å¤‡æ³¨è¯´æ˜
- `confirmed` (bool, optional): æ˜¯å¦ç¡®è®¤è­¦å‘Šï¼Œé»˜è®¤ False

**è¿”å›å€¼ï¼š**
```python
{
    "success": True,
    "batchId": "uuid-string",
    "pullRequestCount": 1,
    "message": "æˆåŠŸåˆ›å»ºæ‰¹æ¬¡ï¼ŒåŒ…å« 1 ä¸ªä¿®æ”¹æè®®"
}

# æˆ–é‡åˆ°å†²çªæ—¶
{
    "success": False,
    "conflicts": [{
        "index": 0,
        "item": {...},
        "error": "è¯æ¡ 'æµ‹è¯•' ä¸ç¼–ç  'ushi' çš„ç»„åˆå·²å­˜åœ¨",
        "reason": "è¯¥è¯æ¡å’Œç¼–ç çš„ç»„åˆå·²åœ¨å­—å…¸ä¸­å­˜åœ¨"
    }],
    "message": "å­˜åœ¨ 1 ä¸ªæ— æ³•è§£å†³çš„å†²çª"
}

# æˆ–é‡åˆ°è­¦å‘Šæ—¶ï¼ˆé‡ç /å¤šç¼–ç ï¼‰
{
    "success": False,
    "warnings": [{
        "index": 0,
        "item": {...},
        "warningType": "duplicate_code",  # æˆ– "multiple_code"
        "message": "ç¼–ç  'ushi' å·²è¢«è¯æ¡ 'æµ‹è¯•' å ç”¨ï¼Œå°†åˆ›å»ºé‡ç ",
        "existing": {
            "word": "æµ‹è¯•",
            "code": "ushi",
            "weight": 0
        }
    }],
    "requiresConfirmation": True,
    "message": "å­˜åœ¨ 1 ä¸ªéœ€è¦ç¡®è®¤çš„è­¦å‘Šï¼ˆé‡ç æˆ–å¤šç¼–ç ï¼‰"
}
```

### keytao_batch_create_phrases

æ‰¹é‡åˆ›å»ºå¤šä¸ªè¯æ¡

**å‚æ•°ï¼š**
- `platform` (str): å¹³å°ç±»å‹ 
- `platform_id` (str): ç”¨æˆ·çš„å¹³å°ID
- `items` (List[Dict]): è¯æ¡åˆ—è¡¨ï¼Œæ¯é¡¹åŒ…å«ï¼š
  - `word` (str): è¯æ¡
  - `code` (str): ç¼–ç 
  - `type` (str, optional): ç±»å‹
  - `remark` (str, optional): å¤‡æ³¨
- `confirmed` (bool, optional): æ˜¯å¦ç¡®è®¤è­¦å‘Š

**è¿”å›å€¼ï¼š** ä¸å•ä¸ªåˆ›å»ºç›¸åŒ

## å¤„ç†æµç¨‹

### 1. åŸºç¡€åˆ›å»ºæµç¨‹

```python
# 1. è·å–ç”¨æˆ·å¹³å°ä¿¡æ¯
platform = "telegram"  # æˆ– "qq"
platform_id = event.get_user_id()

# 2. è°ƒç”¨åˆ›å»ºå‡½æ•°
result = await keytao_create_phrase(
    platform=platform,
    platform_id=platform_id,
    word="æµ‹è¯•",
    code="ushi",
    type="Phrase"
)

# 3. å¤„ç†ç»“æœ
if result["success"]:
    # åˆ›å»ºæˆåŠŸ
    reply = f"âœ… æˆåŠŸæ·»åŠ è¯æ¡ï¼\n\n" \
            f"è¯æ¡ï¼š{word}\n" \
            f"ç¼–ç ï¼š{code}\n" \
            f"æ‰¹æ¬¡IDï¼š{result['batchId']}"
else:
    # å¤„ç†é”™è¯¯
    reply = f"âŒ {result['message']}"
```

### 2. å†²çªå¤„ç†

**çœŸæ­£çš„å†²çªï¼ˆå¿…é¡»æ‹’ç»ï¼‰ï¼š**
- è¯æ¡+ç¼–ç ç»„åˆå·²å­˜åœ¨
- ä¿®æ”¹/åˆ é™¤ä¸å­˜åœ¨çš„è¯æ¡

```python
if not result["success"] and result.get("conflicts"):
    # æ˜¾ç¤ºå†²çªè¯¦æƒ…
    conflict = result["conflicts"][0]
    reply = f"âŒ åˆ›å»ºå¤±è´¥\n\n" \
            f"å†²çªåŸå› ï¼š{conflict['error']}\n" \
            f"è¯´æ˜ï¼š{conflict['reason']}"
```

### 3. è­¦å‘Šå¤„ç†ï¼ˆéœ€è¦ç¡®è®¤ï¼‰

**è­¦å‘Šç±»å‹ï¼š**
- `duplicate_code`: é‡ç ï¼ˆåŒä¸€ç¼–ç å°†æœ‰å¤šä¸ªè¯æ¡ï¼‰
- `multiple_code`: å¤šç¼–ç ï¼ˆåŒä¸€è¯æ¡å°†æœ‰å¤šä¸ªç¼–ç ï¼‰

```python
if not result["success"] and result.get("requiresConfirmation"):
    warning = result["warnings"][0]
    
    if warning["warningType"] == "duplicate_code":
        # é‡ç è­¦å‘Š
        reply = f"âš ï¸ é‡ç è­¦å‘Š\n\n" \
                f"ç¼–ç  {warning['existing']['code']} å·²è¢«ä»¥ä¸‹è¯æ¡å ç”¨ï¼š\n" \
                f"â†’ {warning['existing']['word']} (æƒé‡: {warning['existing']['weight']})\n\n" \
                f"ä½ è¦æ·»åŠ çš„è¯æ¡ '{word}' å°†æˆä¸ºé‡ç ï¼ˆæƒé‡è‡ªåŠ¨åˆ†é…ï¼‰\n\n" \
                f"æ˜¯å¦ç»§ç»­ï¼Ÿå›å¤ /confirm ç¡®è®¤"
        
        # ç­‰å¾…ç”¨æˆ·ç¡®è®¤åï¼Œå†æ¬¡è°ƒç”¨æ—¶è®¾ç½® confirmed=True
        result = await keytao_create_phrase(
            platform=platform,
            platform_id=platform_id,
            word=word,
            code=code,
            confirmed=True  # â† å…³é”®
        )
    
    elif warning["warningType"] == "multiple_code":
        # å¤šç¼–ç è­¦å‘Š
        reply = f"âš ï¸ å¤šç¼–ç è­¦å‘Š\n\n" \
                f"è¯æ¡ '{word}' å·²å­˜åœ¨äºç¼–ç  {warning['existing']['code']}\n" \
                f"ç°åœ¨è¦ä¸ºå®ƒæ·»åŠ æ–°ç¼–ç ï¼š{code}\n\n" \
                f"æ˜¯å¦ç»§ç»­ï¼Ÿå›å¤ /confirm ç¡®è®¤"
```

## AI åŠ©æ‰‹å±•ç¤ºæ ¼å¼

### æˆåŠŸåˆ›å»º

```
âœ… æˆåŠŸæ·»åŠ è¯æ¡ï¼

è¯æ¡ï¼šæµ‹è¯•
ç¼–ç ï¼šushi
ç±»å‹ï¼šè¯ç»„

å·²æäº¤åˆ°å®¡æ ¸æ‰¹æ¬¡ï¼Œç®¡ç†å‘˜å®¡æ ¸é€šè¿‡åå³å¯ç”Ÿæ•ˆã€‚
æ‰¹æ¬¡ID: xxx-xxx-xxx
```

### é‡åˆ°å†²çª

```
âŒ æ·»åŠ å¤±è´¥

åŸå› ï¼šè¯æ¡ "æµ‹è¯•" ä¸ç¼–ç  "ushi" çš„ç»„åˆå·²å­˜åœ¨

ğŸ’¡ å»ºè®®ï¼š
- æ£€æŸ¥è¯æ¡å’Œç¼–ç æ˜¯å¦æ­£ç¡®
- å¦‚æœè¦ä¿®æ”¹å·²æœ‰è¯æ¡ï¼Œè¯·ä½¿ç”¨ä¿®æ”¹åŠŸèƒ½
```

### é‡åˆ°é‡ç è­¦å‘Š

```
âš ï¸ é‡ç æç¤º

ç¼–ç  "ushi" å·²è¢«è¯æ¡ "æµ‹è¯•" å ç”¨ï¼ˆæƒé‡: 0ï¼‰

ä½ è¦æ·»åŠ  "è¯è¯•"ï¼Œå°†åˆ›å»ºé‡ç ï¼š
- ushi â†’ "æµ‹è¯•" (æƒé‡ 0)
- ushi â†’ "è¯è¯•" (æƒé‡ 1) â† æ–°å¢

è¿™æ„å‘³ç€è¾“å…¥ "ushi" æ—¶ï¼Œå€™é€‰æ¡†ä¼šåŒæ—¶æ˜¾ç¤ºä¸¤ä¸ªè¯ã€‚

å¦‚æœç¡®è®¤è¦åˆ›å»ºé‡ç ï¼Œè¯·å›å¤ /confirm
```

## æ³¨æ„äº‹é¡¹

1. **è´¦å·ç»‘å®šæ£€æŸ¥**
   - å¦‚æœè¿”å›"æœªæ‰¾åˆ°ç»‘å®šè´¦å·"ï¼Œå¼•å¯¼ç”¨æˆ·ä½¿ç”¨ `/bind` å‘½ä»¤

2. **å‚æ•°éªŒè¯**
   - ç¡®ä¿ word å’Œ code éƒ½ä¸ä¸ºç©º
   - code å¿…é¡»æ˜¯çº¯å­—æ¯ï¼ˆa-zï¼‰

3. **å†²çªåŒºåˆ†**
   - `conflicts` = çœŸæ­£çš„å†²çªï¼Œæ— æ³•ç»•è¿‡
   - `warnings` = é‡ç /å¤šç¼–ç è­¦å‘Šï¼Œå¯ç¡®è®¤ååˆ›å»º

4. **æ‰¹æ¬¡ç®¡ç†**
   - æ¯æ¬¡åˆ›å»ºä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ‰¹æ¬¡ï¼ˆDraft çŠ¶æ€ï¼‰
   - ç”¨æˆ·å¯åœ¨ç½‘ç«™ä¸ŠæŸ¥çœ‹å’Œç®¡ç†æ‰¹æ¬¡
   - ç®¡ç†å‘˜å®¡æ ¸é€šè¿‡åè¯æ¡æ‰ä¼šç”Ÿæ•ˆ

5. **æƒé‡è‡ªåŠ¨åˆ†é…**
   - åˆ›å»ºé‡ç æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†é…æƒé‡
   - æ— éœ€æ‰‹åŠ¨æŒ‡å®š weight å‚æ•°

## é”™è¯¯å¤„ç†

å¸¸è§é”™è¯¯åŠå¤„ç†ï¼š

| é”™è¯¯ä¿¡æ¯ | åŸå›  | å¤„ç†æ–¹å¼ |
|---------|------|---------|
| æœªæ‰¾åˆ°ç»‘å®šè´¦å· | ç”¨æˆ·æœªç»‘å®š | å¼•å¯¼ä½¿ç”¨ `/bind` |
| ç¼ºå°‘å¿…è¦å­—æ®µ | å‚æ•°ä¸å®Œæ•´ | æç¤ºç”¨æˆ·è¡¥å……ä¿¡æ¯ |
| Boté…ç½®é”™è¯¯ | Tokenæœªé…ç½® | è”ç³»ç®¡ç†å‘˜ |
| è¯·æ±‚è¶…æ—¶ | ç½‘ç»œé—®é¢˜ | å»ºè®®ç¨åé‡è¯• |
